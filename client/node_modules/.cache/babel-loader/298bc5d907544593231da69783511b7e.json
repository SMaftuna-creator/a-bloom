{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\1\\\\Desktop\\\\clnblm\\\\a-bloom\\\\client\\\\src\\\\components\\\\CommentsDisplay.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { UpvoteButton, DownvoteButton } from './VoteButtons';\nimport CommentsAndButtons from './CommentAndButtons';\nimport ReplyAndButtons from './ReplyAndButtons';\nimport { toggleCommentUpvote, toggleCommentDownvote, toggleReplyUpvote, toggleReplyDownvote } from '../reducers/postCommentsReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport TimeAgo from 'timeago-react';\nimport getErrorMsg from '../utils/getErrorMsg';\nimport { Typography, Link } from '@material-ui/core';\nimport { usePostCommentsStyles } from '../styles/muiStyles';\nimport ForumIcon from '@material-ui/icons/Forum';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst CommentsDisplay = _ref => {\n  _s();\n\n  let {\n    comments,\n    postId,\n    isMobile\n  } = _ref;\n  const classes = usePostCommentsStyles();\n  const dispatch = useDispatch();\n  const user = useSelector(state => state.user);\n\n  const handleCommentUpvote = async commentId => {\n    const {\n      upvotedBy,\n      downvotedBy\n    } = comments.find(c => c.id === commentId);\n\n    try {\n      if (upvotedBy.includes(user.id)) {\n        const updatedUpvotedBy = upvotedBy.filter(u => u !== user.id);\n        dispatch(toggleCommentUpvote(postId, commentId, updatedUpvotedBy, downvotedBy));\n      } else {\n        const updatedUpvotedBy = [...upvotedBy, user.id];\n        const updatedDownvotedBy = downvotedBy.filter(d => d !== user.id);\n        dispatch(toggleCommentUpvote(postId, commentId, updatedUpvotedBy, updatedDownvotedBy));\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleCommentDownvote = async commentId => {\n    const {\n      upvotedBy,\n      downvotedBy\n    } = comments.find(c => c.id === commentId);\n\n    try {\n      if (downvotedBy.includes(user.id)) {\n        const updatedDownvotedBy = downvotedBy.filter(d => d !== user.id);\n        dispatch(toggleCommentDownvote(postId, commentId, updatedDownvotedBy, upvotedBy));\n      } else {\n        const updatedDownvotedBy = [...downvotedBy, user.id];\n        const updatedUpvotedBy = upvotedBy.filter(u => u !== user.id);\n        dispatch(toggleCommentDownvote(postId, commentId, updatedDownvotedBy, updatedUpvotedBy));\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleReplyUpvote = async (commentId, replyId) => {\n    const targetComment = comments.find(c => c.id === commentId);\n    const {\n      upvotedBy,\n      downvotedBy\n    } = targetComment.replies.find(r => r.id === replyId);\n\n    try {\n      if (upvotedBy.includes(user.id)) {\n        const updatedUpvotedBy = upvotedBy.filter(u => u !== user.id);\n        dispatch(toggleReplyUpvote(postId, commentId, replyId, updatedUpvotedBy, downvotedBy));\n      } else {\n        const updatedUpvotedBy = [...upvotedBy, user.id];\n        const updatedDownvotedBy = downvotedBy.filter(d => d !== user.id);\n        dispatch(toggleReplyUpvote(postId, commentId, replyId, updatedUpvotedBy, updatedDownvotedBy));\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleReplyDownvote = async (commentId, replyId) => {\n    const targetComment = comments.find(c => c.id === commentId);\n    const {\n      upvotedBy,\n      downvotedBy\n    } = targetComment.replies.find(r => r.id === replyId);\n\n    try {\n      if (downvotedBy.includes(user.id)) {\n        const updatedDownvotedBy = downvotedBy.filter(d => d !== user.id);\n        dispatch(toggleReplyDownvote(postId, commentId, replyId, updatedDownvotedBy, upvotedBy));\n      } else {\n        const updatedDownvotedBy = [...downvotedBy, user.id];\n        const updatedUpvotedBy = upvotedBy.filter(u => u !== user.id);\n        dispatch(toggleReplyDownvote(postId, commentId, replyId, updatedDownvotedBy, updatedUpvotedBy));\n      }\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const commentDetails = (by, comment) => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"caption\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          component: RouterLink,\n          to: `/u/${by.username}`,\n          children: by.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), ` ${comment.pointsCount} ${comment.pointsCount === 1 ? 'point' : 'points'} • `, /*#__PURE__*/_jsxDEV(TimeAgo, {\n          datetime: new Date(comment.createdAt)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), comment.createdAt !== comment.updatedAt && /*#__PURE__*/_jsxDEV(\"em\", {\n          children: [' • edited', \" \", /*#__PURE__*/_jsxDEV(TimeAgo, {\n            datetime: new Date(comment.updatedAt)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.commentsContainer,\n    children: comments.length !== 0 ? comments.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.wholeComment,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.commentWrapper,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.commentVotesWrapper,\n          children: [/*#__PURE__*/_jsxDEV(UpvoteButton, {\n            user: user,\n            body: c,\n            handleUpvote: () => handleCommentUpvote(c.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(DownvoteButton, {\n            user: user,\n            body: c,\n            handleDownvote: () => handleCommentDownvote(c.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.commentDetails,\n          children: [commentDetails(c.commentedBy, c), /*#__PURE__*/_jsxDEV(CommentsAndButtons, {\n            isMobile: isMobile,\n            comment: c,\n            postId: postId,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 13\n      }, this), c.replies.map(r => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.replyWrapper,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.commentVotesWrapper,\n          children: [/*#__PURE__*/_jsxDEV(UpvoteButton, {\n            user: user,\n            body: r,\n            handleUpvote: () => handleReplyUpvote(c.id, r.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(DownvoteButton, {\n            user: user,\n            body: r,\n            handleDownvote: () => handleReplyDownvote(c.id, r.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.commentDetails,\n          children: [commentDetails(r.repliedBy, r), /*#__PURE__*/_jsxDEV(ReplyAndButtons, {\n            isMobile: isMobile,\n            reply: r,\n            postId: postId,\n            commentId: c.id,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 17\n        }, this)]\n      }, r.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 15\n      }, this))]\n    }, c.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.noCommentsBanner,\n      children: [/*#__PURE__*/_jsxDEV(ForumIcon, {\n        color: \"primary\",\n        fontSize: \"large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        color: \"secondary\",\n        children: \"No Comments Yet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        color: \"secondary\",\n        children: \"Be the first to share what you think!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CommentsDisplay, \"tDNmiZacjOtXmIdpJFvInw2MFD0=\", false, function () {\n  return [usePostCommentsStyles, useDispatch, useSelector];\n});\n\n_c = CommentsDisplay;\nexport default CommentsDisplay;\n\nvar _c;\n\n$RefreshReg$(_c, \"CommentsDisplay\");","map":{"version":3,"sources":["C:/Users/1/Desktop/clnblm/a-bloom/client/src/components/CommentsDisplay.js"],"names":["React","useSelector","useDispatch","Link","RouterLink","UpvoteButton","DownvoteButton","CommentsAndButtons","ReplyAndButtons","toggleCommentUpvote","toggleCommentDownvote","toggleReplyUpvote","toggleReplyDownvote","notify","TimeAgo","getErrorMsg","Typography","usePostCommentsStyles","ForumIcon","CommentsDisplay","comments","postId","isMobile","classes","dispatch","user","state","handleCommentUpvote","commentId","upvotedBy","downvotedBy","find","c","id","includes","updatedUpvotedBy","filter","u","updatedDownvotedBy","d","err","handleCommentDownvote","handleReplyUpvote","replyId","targetComment","replies","r","handleReplyDownvote","commentDetails","by","comment","username","pointsCount","Date","createdAt","updatedAt","commentsContainer","length","map","wholeComment","commentWrapper","commentVotesWrapper","commentedBy","replyWrapper","repliedBy","noCommentsBanner"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport { UpvoteButton, DownvoteButton } from './VoteButtons';\r\nimport CommentsAndButtons from './CommentAndButtons';\r\nimport ReplyAndButtons from './ReplyAndButtons';\r\nimport {\r\n  toggleCommentUpvote,\r\n  toggleCommentDownvote,\r\n  toggleReplyUpvote,\r\n  toggleReplyDownvote,\r\n} from '../reducers/postCommentsReducer';\r\nimport { notify } from '../reducers/notificationReducer';\r\nimport TimeAgo from 'timeago-react';\r\nimport getErrorMsg from '../utils/getErrorMsg';\r\n\r\nimport { Typography, Link } from '@material-ui/core';\r\nimport { usePostCommentsStyles } from '../styles/muiStyles';\r\nimport ForumIcon from '@material-ui/icons/Forum';\r\n\r\nconst CommentsDisplay = ({ comments, postId, isMobile }) => {\r\n  const classes = usePostCommentsStyles();\r\n  const dispatch = useDispatch();\r\n  const user = useSelector((state) => state.user);\r\n\r\n  const handleCommentUpvote = async (commentId) => {\r\n    const { upvotedBy, downvotedBy } = comments.find((c) => c.id === commentId);\r\n\r\n    try {\r\n      if (upvotedBy.includes(user.id)) {\r\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\r\n        dispatch(\r\n          toggleCommentUpvote(postId, commentId, updatedUpvotedBy, downvotedBy)\r\n        );\r\n      } else {\r\n        const updatedUpvotedBy = [...upvotedBy, user.id];\r\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\r\n        dispatch(\r\n          toggleCommentUpvote(\r\n            postId,\r\n            commentId,\r\n            updatedUpvotedBy,\r\n            updatedDownvotedBy\r\n          )\r\n        );\r\n      }\r\n    } catch (err) {\r\n      dispatch(notify(getErrorMsg(err), 'error'));\r\n    }\r\n  };\r\n\r\n  const handleCommentDownvote = async (commentId) => {\r\n    const { upvotedBy, downvotedBy } = comments.find((c) => c.id === commentId);\r\n\r\n    try {\r\n      if (downvotedBy.includes(user.id)) {\r\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\r\n        dispatch(\r\n          toggleCommentDownvote(\r\n            postId,\r\n            commentId,\r\n            updatedDownvotedBy,\r\n            upvotedBy\r\n          )\r\n        );\r\n      } else {\r\n        const updatedDownvotedBy = [...downvotedBy, user.id];\r\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\r\n        dispatch(\r\n          toggleCommentDownvote(\r\n            postId,\r\n            commentId,\r\n            updatedDownvotedBy,\r\n            updatedUpvotedBy\r\n          )\r\n        );\r\n      }\r\n    } catch (err) {\r\n      dispatch(notify(getErrorMsg(err), 'error'));\r\n    }\r\n  };\r\n\r\n  const handleReplyUpvote = async (commentId, replyId) => {\r\n    const targetComment = comments.find((c) => c.id === commentId);\r\n    const { upvotedBy, downvotedBy } = targetComment.replies.find(\r\n      (r) => r.id === replyId\r\n    );\r\n\r\n    try {\r\n      if (upvotedBy.includes(user.id)) {\r\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\r\n        dispatch(\r\n          toggleReplyUpvote(\r\n            postId,\r\n            commentId,\r\n            replyId,\r\n            updatedUpvotedBy,\r\n            downvotedBy\r\n          )\r\n        );\r\n      } else {\r\n        const updatedUpvotedBy = [...upvotedBy, user.id];\r\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\r\n        dispatch(\r\n          toggleReplyUpvote(\r\n            postId,\r\n            commentId,\r\n            replyId,\r\n            updatedUpvotedBy,\r\n            updatedDownvotedBy\r\n          )\r\n        );\r\n      }\r\n    } catch (err) {\r\n      dispatch(notify(getErrorMsg(err), 'error'));\r\n    }\r\n  };\r\n\r\n  const handleReplyDownvote = async (commentId, replyId) => {\r\n    const targetComment = comments.find((c) => c.id === commentId);\r\n    const { upvotedBy, downvotedBy } = targetComment.replies.find(\r\n      (r) => r.id === replyId\r\n    );\r\n\r\n    try {\r\n      if (downvotedBy.includes(user.id)) {\r\n        const updatedDownvotedBy = downvotedBy.filter((d) => d !== user.id);\r\n        dispatch(\r\n          toggleReplyDownvote(\r\n            postId,\r\n            commentId,\r\n            replyId,\r\n            updatedDownvotedBy,\r\n            upvotedBy\r\n          )\r\n        );\r\n      } else {\r\n        const updatedDownvotedBy = [...downvotedBy, user.id];\r\n        const updatedUpvotedBy = upvotedBy.filter((u) => u !== user.id);\r\n        dispatch(\r\n          toggleReplyDownvote(\r\n            postId,\r\n            commentId,\r\n            replyId,\r\n            updatedDownvotedBy,\r\n            updatedUpvotedBy\r\n          )\r\n        );\r\n      }\r\n    } catch (err) {\r\n      dispatch(notify(getErrorMsg(err), 'error'));\r\n    }\r\n  };\r\n\r\n  const commentDetails = (by, comment) => {\r\n    return (\r\n      <>\r\n        <Typography variant=\"caption\">\r\n          <Link component={RouterLink} to={`/u/${by.username}`}>\r\n            {by.username}\r\n          </Link>\r\n          {` ${comment.pointsCount} ${\r\n            comment.pointsCount === 1 ? 'point' : 'points'\r\n          } • `}\r\n          <TimeAgo datetime={new Date(comment.createdAt)} />\r\n          {comment.createdAt !== comment.updatedAt && (\r\n            <em>\r\n              {' • edited'} <TimeAgo datetime={new Date(comment.updatedAt)} />\r\n            </em>\r\n          )}\r\n        </Typography>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={classes.commentsContainer}>\r\n      {comments.length !== 0 ? (\r\n        comments.map((c) => (\r\n          <div key={c.id} className={classes.wholeComment}>\r\n            <div className={classes.commentWrapper}>\r\n              <div className={classes.commentVotesWrapper}>\r\n                <UpvoteButton\r\n                  user={user}\r\n                  body={c}\r\n                  handleUpvote={() => handleCommentUpvote(c.id)}\r\n                />\r\n                <DownvoteButton\r\n                  user={user}\r\n                  body={c}\r\n                  handleDownvote={() => handleCommentDownvote(c.id)}\r\n                />\r\n              </div>\r\n              <div className={classes.commentDetails}>\r\n                {commentDetails(c.commentedBy, c)}\r\n                <CommentsAndButtons\r\n                  isMobile={isMobile}\r\n                  comment={c}\r\n                  postId={postId}\r\n                  user={user}\r\n                />\r\n              </div>\r\n            </div>\r\n            {c.replies.map((r) => (\r\n              <div key={r.id} className={classes.replyWrapper}>\r\n                <div className={classes.commentVotesWrapper}>\r\n                  <UpvoteButton\r\n                    user={user}\r\n                    body={r}\r\n                    handleUpvote={() => handleReplyUpvote(c.id, r.id)}\r\n                  />\r\n                  <DownvoteButton\r\n                    user={user}\r\n                    body={r}\r\n                    handleDownvote={() => handleReplyDownvote(c.id, r.id)}\r\n                  />\r\n                </div>\r\n                <div className={classes.commentDetails}>\r\n                  {commentDetails(r.repliedBy, r)}\r\n                  <ReplyAndButtons\r\n                    isMobile={isMobile}\r\n                    reply={r}\r\n                    postId={postId}\r\n                    commentId={c.id}\r\n                    user={user}\r\n                  />\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div className={classes.noCommentsBanner}>\r\n          <ForumIcon color=\"primary\" fontSize=\"large\" />\r\n          <Typography variant=\"h5\" color=\"secondary\">\r\n            No Comments Yet\r\n          </Typography>\r\n          <Typography variant=\"h6\" color=\"secondary\">\r\n            Be the first to share what you think!\r\n          </Typography>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CommentsDisplay;\r\n"]},"metadata":{},"sourceType":"module"}